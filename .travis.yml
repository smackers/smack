language: generic
dist: trusty
sudo: required
compiler: clang

env:
  global:
    - COMPILER_NAME=clang COMPILER=clang++ CXX=clang++ CC=clang
  matrix:
    - TRAVIS_ENV="--exhaustive --folder=basic"
    - TRAVIS_ENV="--exhaustive --folder=ntdrivers-simplified"
    - TRAVIS_ENV="--exhaustive --folder=pthread_extras"
    - TRAVIS_ENV="--exhaustive --folder=bits"
    - TRAVIS_ENV="--exhaustive --folder=float"
    - TRAVIS_ENV="--exhaustive --folder=locks"
    - TRAVIS_ENV="--exhaustive --folder=contracts"
    - TRAVIS_ENV="--exhaustive --folder=memory-safety"
    - TRAVIS_ENV="--exhaustive --folder=pthread"

before_install:
  - sudo rm -rf /usr/local/clang-3.5.0
  - sudo add-apt-repository "deb http://llvm-apt.ecranbleu.org/apt/trusty/ llvm-toolchain-trusty-3.7 main"
  - wget -O - http://llvm-apt.ecranbleu.org/apt/llvm-snapshot.gpg.key | sudo apt-key add -
  - sudo apt-get update

install:
  - sudo apt-get install -y clang-3.7 llvm-3.7
  - sudo update-alternatives --install /usr/bin/clang clang /usr/bin/clang-3.7 20
  - sudo update-alternatives --install /usr/bin/clang++ clang++ /usr/bin/clang++-3.7 20
  - sudo update-alternatives --install /usr/bin/llvm-config llvm-config /usr/bin/llvm-config-3.7 20
  - sudo update-alternatives --install /usr/bin/llvm-link llvm-link /usr/bin/llvm-link-3.7 20
  - sudo update-alternatives --install /usr/bin/llvm-dis llvm-dis /usr/bin/llvm-dis-3.7 20

script:
  - $CXX --version
  - $CC --version
  - clang --version
  - clang++ --version
  - ./bin/build.sh

